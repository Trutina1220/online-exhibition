<html>
<head>
  <title>CG - Babylon</title>
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
  <script src="https://preview.babylonjs.com/babylon.js"></script>
  <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
  <script src="https://code.jquery.com/pep/0.4.3/pep.js"></script>
  <style>
    html, body {
      overflow: hidden;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #render {
      width: 100%;
      height: 100%;
      touch-action: none;
    }
  </style>
</head>

<body>
  <canvas id="render" touch-action="none">
  <script>
    var canvas = document.getElementById("render");
    var engine = new BABYLON.Engine(canvas, true);
    var isMoving = false;
    
    // create scene
    var createScene = function() {
      var scene = new BABYLON.Scene(engine);
      
        
      var camera = new BABYLON.FlyCamera("Camera",  new 
      BABYLON.Vector3(0,1,0, scene));


      
      
      camera.attachControl(canvas, true);
      

      var ground = BABYLON.Mesh.CreateBox("box",10, scene);
      ground.scaling= new BABYLON.Vector3(20,0.1,8);
      ground.position.x = 8;
      ground.position.y = -1;

      var table = BABYLON.Mesh.CreateBox("table",2, scene);
      table.scaling = new BABYLON.Vector3(1,0.5,1);
      table.position.x = 2;
      
      var tableMaterial = new BABYLON.StandardMaterial("table", scene);
      tableMaterial.emissiveColor = new BABYLON.Color3(0, 0.58, 0.86);
      table.material = tableMaterial;
      

      

      var lambo = BABYLON.SceneLoader.ImportMesh("", "car/", "copy-of-lamborghini-aventador.obj",scene, function (newMeshes) {
        scene.createDefaultLight(true, true, true);
        lamboMeshes = newMeshes;
         

        for (mesh in newMeshes) {
          newMeshes[mesh].scaling = new BABYLON.Vector3(0.1, 0.1, 0.1);
          newMeshes[mesh].position = new BABYLON.Vector3( 1.2, 0.5, 0);
          newMeshes[mesh].rotation.y = Math.PI/2 + Math.PI/2 + Math.PI/2 ;
          newMeshes[mesh].actionManager = new BABYLON.ActionManager(scene);
          
        }
        
      });

      var mammot = BABYLON.SceneLoader.ImportMesh("", "models/woolly-mammoth-skeleton-obj/", "woolly-mammoth-skeleton.obj",scene, function (newMeshes) {
        scene.createDefaultLight(true, true, true);
        
        var mat = new BABYLON.StandardMaterial("mat", scene);
        var texture = new BABYLON.Texture("models/woolly-mammoth-skeleton-obj/ClayColor.jpg", scene);
        mat.diffuseTexture = texture;
        for (mesh in newMeshes) {
          newMeshes[mesh].scaling = new BABYLON.Vector3(0.0001, 0.0001, 0.0001);
          newMeshes[mesh].position = new BABYLON.Vector3( 1.5, 0.7, 0);
          newMeshes[mesh].rotation.y = Math.PI/2 + Math.PI/2;
          newMeshes[mesh].actionManager = new BABYLON.ActionManager(scene);
          newMeshes[mesh].material = mat;
          
        }
        
      });

      var bee = BABYLON.SceneLoader.ImportMesh("", "models/bumblebee-transformer-animation-obj/", "bumblebee-transformer-animation.obj",scene, function (newMeshes) {
        scene.createDefaultLight(true, true, true);
        
        
        for (mesh in newMeshes) {
          newMeshes[mesh].scaling = new BABYLON.Vector3(0.001, 0.001, 0.001);
          newMeshes[mesh].position = new BABYLON.Vector3( 1.9, 0.5, 0);
          newMeshes[mesh].rotation.y = Math.PI/2 + Math.PI/2;
          newMeshes[mesh].actionManager = new BABYLON.ActionManager(scene);
          
        }
        
      });

      var juliet = BABYLON.SceneLoader.ImportMesh("", "models/juliet-purple-pride-obj/", "juliet-purple-pride.obj",scene, function (newMeshes) {
        scene.createDefaultLight(true, true, true);
        for (mesh in newMeshes) {
          newMeshes[mesh].scaling = new BABYLON.Vector3(0.0015, 0.0015, 0.0015);
          newMeshes[mesh].position = new BABYLON.Vector3( 2.2, 0.5, 0);
          newMeshes[mesh].rotation.y = Math.PI/2 + Math.PI/2;
          newMeshes[mesh].actionManager = new BABYLON.ActionManager(scene);
          
        }
        
      });



      BABYLON.SceneLoader.ImportMesh("", "house/", "house.obj",scene, function (newMeshes) {
        scene.createDefaultLight(true, true, true);
        
        for (mesh in newMeshes) {
          newMeshes[mesh].scaling = new BABYLON.Vector3(0.01 , 0.01, 0.01);
          newMeshes[mesh].rotation.y = Math.PI/2;
          newMeshes[mesh].position = new BABYLON.Vector3( 14, 0, 0);
        }
      });

   
      
      return scene;
    }


    var scene = createScene();

    var currentDistanceTravelled = 0;
    var maxDistanceTravelled = 95;

    engine.runRenderLoop(function() {

      if(isMoving) {
        if(currentDistanceTravelled <= maxDistanceTravelled){
          currentDistanceTravelled++;
          if(isMoving){
          
            for (mesh in lamboMeshes){
              lamboMeshes[mesh].position.x += 0.1;
              
            }
          }
        }
        else {
          isMoving = false;
          endCamera = scene.getCameraByName("Camera"); 
          endCamera.setPosition(new BABYLON.Vector3(5,5,-2));
        }
      }

      scene.render();
    });
    window.addEventListener("resize", function() {
      engine.resize();
    });
  </script>
</body>
</html>
